{% extends 'base.html' %}

{% block title %}日記之森 | 心理日記{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/common/starry_background.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/modules/diary/diary_form.css') }}">
<script src="{{ url_for('static', filename='js/common/starry_background.js') }}"></script>
<script src="{{ url_for('static', filename='js/modules/diary/diary_form.js') }}"></script>
{% endblock %}

{% block content %}
<!-- 統一星空背景系統 -->
{% include 'components/starry_background.html' %}

<!-- 日記表單容器 -->
<div class="form-container">
    <h2 class="form-title">我的心理日記</h2>

    <!-- 儲存成功提示 -->
    <div id="success-alert" class="alert alert-success" role="alert">
        日記已成功儲存！
    </div>
    <!-- 錯誤訊息提示 -->
    <div id="error-alert" class="alert alert-danger" role="alert">
        發生錯誤，請稍後再試。
    </div>

    <!-- ✨ AI 回覆區塊（預設隱藏） -->
    <div id="ai-response-box" class="ai-response-box">
        <h3 class="ai-response-title">AI 小助手的回饋</h3>
        <p id="ai-response-content" class="ai-response-content"></p>
    </div>

    <!-- 日記表單 -->
    <div>
        <!-- 日期 -->
        <div class="form-group">
            <div class="input-wrapper">
                <label for="diary-date"><i class="fas fa-calendar-alt"></i> 日期</label>
                <input type="date" id="diary-date" class="form-control" value="{{ today_date }}" required>
            </div>
        </div>

        <!-- 內容 -->
        <div class="form-group">
            <div class="input-wrapper">
                <label for="diary-content"><i class="fas fa-pen-fancy"></i> 今天的心情...</label>
                <textarea id="diary-content" class="form-control textarea-control"
                          placeholder="今天發生了什麼？感受如何？詳細地描述您的情緒、成因，想法..." rows="8"></textarea>
            </div>
        </div>

        <!-- 送出 -->
        <div class="form-group">
            <div class="input-wrapper">
                <button id="submit-diary"
                        class="btn-submit"
                        data-save-url="{{ url_for('diary.save_diary') }}">
                    <i class="fas fa-save"></i> 儲存日記
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
